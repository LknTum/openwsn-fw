\hypertarget{disk_8c}{}\section{/home/lkn/off\+Cloud/\+Smartgrid-\/code/\+Git\+Hub/openwsn-\/fw/bootloader/k20/disk\+\_\+flash\+\_\+utils/disk.c File Reference}
\label{disk_8c}\index{/home/lkn/off\+Cloud/\+Smartgrid-\/code/\+Git\+Hub/openwsn-\/fw/bootloader/k20/disk\+\_\+flash\+\_\+utils/disk.\+c@{/home/lkn/off\+Cloud/\+Smartgrid-\/code/\+Git\+Hub/openwsn-\/fw/bootloader/k20/disk\+\_\+flash\+\_\+utils/disk.\+c}}
{\ttfamily \#include \char`\"{}types.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}hidef.\+h\char`\"{}}\\*
{\ttfamily \#include $<$string.\+h$>$}\\*
{\ttfamily \#include $<$stdlib.\+h$>$}\\*
{\ttfamily \#include \char`\"{}stdio.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}derivative.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}usb\+\_\+msc.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}disk.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}usb\+\_\+class.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}F\+A\+T16.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}Bootloader.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}Boot\+\_\+loader\+\_\+task.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}flash\+\_\+\+F\+T\+F\+L.\+h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{usb__devapi_8h_afabf60e7f57651d6d595a02c75f07cd0}{void} \hyperlink{disk_8c_a076dd416993af0e3c52876f1eb6b3e5b}{Test\+App\+\_\+\+Init} (\hyperlink{usb__devapi_8h_afabf60e7f57651d6d595a02c75f07cd0}{void})
\begin{DoxyCompactList}\small\item\em R\+AM Disk has been emulated via this Mass Storage Demo. Based on Ram disck from freescale. \end{DoxyCompactList}\item 
\hyperlink{usb__devapi_8h_afabf60e7f57651d6d595a02c75f07cd0}{void} \hyperlink{disk_8c_a190387c76923ea2706b0f09d77a1943c}{Watchdog\+\_\+\+Reset} (\hyperlink{usb__devapi_8h_afabf60e7f57651d6d595a02c75f07cd0}{void})
\item 
\hyperlink{usb__devapi_8h_afabf60e7f57651d6d595a02c75f07cd0}{void} \hyperlink{disk_8c_a494be22b15bac7c11c6136e69f7b469c}{U\+S\+B\+\_\+\+App\+\_\+\+Callback} (\hyperlink{types_8h_ad3209046c23f739a81581c10a4be7d92}{uint\+\_\+8} controller\+\_\+\+ID, \hyperlink{types_8h_ad3209046c23f739a81581c10a4be7d92}{uint\+\_\+8} event\+\_\+type, \hyperlink{usb__devapi_8h_afabf60e7f57651d6d595a02c75f07cd0}{void} $\ast$val)
\item 
\hyperlink{usb__devapi_8h_afabf60e7f57651d6d595a02c75f07cd0}{void} \hyperlink{disk_8c_a42d9ebb70ff214cceda2524d16a2b0c6}{M\+S\+D\+\_\+\+Event\+\_\+\+Callback} (\hyperlink{types_8h_ad3209046c23f739a81581c10a4be7d92}{uint\+\_\+8} controller\+\_\+\+ID, \hyperlink{types_8h_ad3209046c23f739a81581c10a4be7d92}{uint\+\_\+8} event\+\_\+type, \hyperlink{usb__devapi_8h_afabf60e7f57651d6d595a02c75f07cd0}{void} $\ast$val)
\item 
\hyperlink{usb__devapi_8h_afabf60e7f57651d6d595a02c75f07cd0}{void} \hyperlink{disk_8c_a9851248548dce0fc017bcc7f61218b31}{Disk\+\_\+\+App} (\hyperlink{usb__devapi_8h_afabf60e7f57651d6d595a02c75f07cd0}{void})
\item 
\hyperlink{usb__devapi_8h_afabf60e7f57651d6d595a02c75f07cd0}{void} \hyperlink{disk_8c_a9fe3484925f03a6112174649a531553d}{Test\+App\+\_\+\+Task} (\hyperlink{usb__devapi_8h_afabf60e7f57651d6d595a02c75f07cd0}{void})
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{types_8h_ad3209046c23f739a81581c10a4be7d92}{uint\+\_\+8} \hyperlink{disk_8c_a981c2dadd44a0af32a67280b58013d5b}{filetype}
\begin{DoxyCompactList}\small\item\em Include the OS and B\+SP dependent files that define IO functions and basic types. You may like to change these files for your board and R\+T\+OS. Based on Freescale bootloader demo for k60. \end{DoxyCompactList}\item 
\hyperlink{types_8h_a5532400b872b4aa84e54335bf458a318}{uint\+\_\+32} \hyperlink{disk_8c_a483026139decebabd2f38b1dc898b594}{file\+\_\+size}
\item 
\hyperlink{types_8h_ad3209046c23f739a81581c10a4be7d92}{uint\+\_\+8} \hyperlink{disk_8c_aa62e071f0cf36ef7c535556e3a6df025}{new\+\_\+file}
\item 
\hyperlink{types_8h_ad3209046c23f739a81581c10a4be7d92}{uint\+\_\+8} \hyperlink{disk_8c_ad018a3100b2dabad325a0800152db297}{error} =\hyperlink{disk_8h_a53b22174bd5debd617b3b5e1377d1aa7}{F\+L\+A\+S\+H\+\_\+\+I\+M\+A\+G\+E\+\_\+\+S\+U\+C\+C\+E\+SS}
\item 
\hyperlink{types_8h_a7670a4e8a07d9ebb00411948b0bbf86d}{boolean} \hyperlink{disk_8c_aca51504c938575b66a532de0307eab3e}{boot\+\_\+complete} = \hyperlink{opendefs_8h_aa93f0eb578d23995850d61f7d61c55c1}{F\+A\+L\+SE}
\item 
\hyperlink{disk_8h_a70c6b453ff5aa5631878e2d8a7e298ee}{D\+I\+S\+K\+\_\+\+G\+L\+O\+B\+A\+L\+\_\+\+V\+A\+R\+I\+A\+B\+L\+E\+\_\+\+S\+T\+R\+U\+CT} \hyperlink{disk_8c_a6ade0b9aa9eb867f1124343246db610b}{g\+\_\+disk}
\item 
unsigned char \hyperlink{disk_8c_ac33574176777f2bea58c140aab41142c}{Bootloader\+Status} = \hyperlink{disk_8h_a6d96ed9d5da79db7dddd1a11c89263f2}{Bootloader\+Ready}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{disk.\+c@{disk.\+c}!Disk\+\_\+\+App@{Disk\+\_\+\+App}}
\index{Disk\+\_\+\+App@{Disk\+\_\+\+App}!disk.\+c@{disk.\+c}}
\subsubsection[{\texorpdfstring{Disk\+\_\+\+App(void)}{Disk_App(void)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} Disk\+\_\+\+App (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}\hypertarget{disk_8c_a9851248548dce0fc017bcc7f61218b31}{}\label{disk_8c_a9851248548dce0fc017bcc7f61218b31}


Definition at line 94 of file disk.\+c.

\index{disk.\+c@{disk.\+c}!M\+S\+D\+\_\+\+Event\+\_\+\+Callback@{M\+S\+D\+\_\+\+Event\+\_\+\+Callback}}
\index{M\+S\+D\+\_\+\+Event\+\_\+\+Callback@{M\+S\+D\+\_\+\+Event\+\_\+\+Callback}!disk.\+c@{disk.\+c}}
\subsubsection[{\texorpdfstring{M\+S\+D\+\_\+\+Event\+\_\+\+Callback(uint\+\_\+8 controller\+\_\+\+I\+D, uint\+\_\+8 event\+\_\+type, void $\ast$val)}{MSD_Event_Callback(uint_8 controller_ID, uint_8 event_type, void *val)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} M\+S\+D\+\_\+\+Event\+\_\+\+Callback (
\begin{DoxyParamCaption}
\item[{{\bf uint\+\_\+8}}]{controller\+\_\+\+ID, }
\item[{{\bf uint\+\_\+8}}]{event\+\_\+type, }
\item[{{\bf void} $\ast$}]{val}
\end{DoxyParamCaption}
)}\hypertarget{disk_8c_a42d9ebb70ff214cceda2524d16a2b0c6}{}\label{disk_8c_a42d9ebb70ff214cceda2524d16a2b0c6}


Definition at line 174 of file disk.\+c.

\index{disk.\+c@{disk.\+c}!Test\+App\+\_\+\+Init@{Test\+App\+\_\+\+Init}}
\index{Test\+App\+\_\+\+Init@{Test\+App\+\_\+\+Init}!disk.\+c@{disk.\+c}}
\subsubsection[{\texorpdfstring{Test\+App\+\_\+\+Init(void)}{TestApp_Init(void)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} Test\+App\+\_\+\+Init (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}\hypertarget{disk_8c_a076dd416993af0e3c52876f1eb6b3e5b}{}\label{disk_8c_a076dd416993af0e3c52876f1eb6b3e5b}


R\+AM Disk has been emulated via this Mass Storage Demo. Based on Ram disck from freescale. 

Main File Based on Freescale demo for k60 bootloader.

\begin{DoxyAuthor}{Author}
Xavi Vilajosana \href{mailto:xvilajosana@eecs.berkeley.edu}{\tt xvilajosana@eecs.\+berkeley.\+edu}, June 2012. 
\end{DoxyAuthor}


Definition at line 320 of file disk.\+c.

\index{disk.\+c@{disk.\+c}!Test\+App\+\_\+\+Task@{Test\+App\+\_\+\+Task}}
\index{Test\+App\+\_\+\+Task@{Test\+App\+\_\+\+Task}!disk.\+c@{disk.\+c}}
\subsubsection[{\texorpdfstring{Test\+App\+\_\+\+Task(void)}{TestApp_Task(void)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} Test\+App\+\_\+\+Task (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}\hypertarget{disk_8c_a9fe3484925f03a6112174649a531553d}{}\label{disk_8c_a9fe3484925f03a6112174649a531553d}


Definition at line 352 of file disk.\+c.

\index{disk.\+c@{disk.\+c}!U\+S\+B\+\_\+\+App\+\_\+\+Callback@{U\+S\+B\+\_\+\+App\+\_\+\+Callback}}
\index{U\+S\+B\+\_\+\+App\+\_\+\+Callback@{U\+S\+B\+\_\+\+App\+\_\+\+Callback}!disk.\+c@{disk.\+c}}
\subsubsection[{\texorpdfstring{U\+S\+B\+\_\+\+App\+\_\+\+Callback(uint\+\_\+8 controller\+\_\+\+I\+D, uint\+\_\+8 event\+\_\+type, void $\ast$val)}{USB_App_Callback(uint_8 controller_ID, uint_8 event_type, void *val)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} U\+S\+B\+\_\+\+App\+\_\+\+Callback (
\begin{DoxyParamCaption}
\item[{{\bf uint\+\_\+8}}]{controller\+\_\+\+ID, }
\item[{{\bf uint\+\_\+8}}]{event\+\_\+type, }
\item[{{\bf void} $\ast$}]{val}
\end{DoxyParamCaption}
)}\hypertarget{disk_8c_a494be22b15bac7c11c6136e69f7b469c}{}\label{disk_8c_a494be22b15bac7c11c6136e69f7b469c}


Definition at line 130 of file disk.\+c.

\index{disk.\+c@{disk.\+c}!Watchdog\+\_\+\+Reset@{Watchdog\+\_\+\+Reset}}
\index{Watchdog\+\_\+\+Reset@{Watchdog\+\_\+\+Reset}!disk.\+c@{disk.\+c}}
\subsubsection[{\texorpdfstring{Watchdog\+\_\+\+Reset(void)}{Watchdog_Reset(void)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} Watchdog\+\_\+\+Reset (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}\hypertarget{disk_8c_a190387c76923ea2706b0f09d77a1943c}{}\label{disk_8c_a190387c76923ea2706b0f09d77a1943c}


Definition at line 39 of file wdt\+\_\+kinetis.\+c.



\subsection{Variable Documentation}
\index{disk.\+c@{disk.\+c}!boot\+\_\+complete@{boot\+\_\+complete}}
\index{boot\+\_\+complete@{boot\+\_\+complete}!disk.\+c@{disk.\+c}}
\subsubsection[{\texorpdfstring{boot\+\_\+complete}{boot_complete}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf boolean} boot\+\_\+complete = {\bf F\+A\+L\+SE}}\hypertarget{disk_8c_aca51504c938575b66a532de0307eab3e}{}\label{disk_8c_aca51504c938575b66a532de0307eab3e}


Definition at line 46 of file disk.\+c.

\index{disk.\+c@{disk.\+c}!Bootloader\+Status@{Bootloader\+Status}}
\index{Bootloader\+Status@{Bootloader\+Status}!disk.\+c@{disk.\+c}}
\subsubsection[{\texorpdfstring{Bootloader\+Status}{BootloaderStatus}}]{\setlength{\rightskip}{0pt plus 5cm}unsigned char Bootloader\+Status = {\bf Bootloader\+Ready}}\hypertarget{disk_8c_ac33574176777f2bea58c140aab41142c}{}\label{disk_8c_ac33574176777f2bea58c140aab41142c}
\index{disk.\+c@{disk.\+c}!error@{error}}
\index{error@{error}!disk.\+c@{disk.\+c}}
\subsubsection[{\texorpdfstring{error}{error}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf uint\+\_\+8} error ={\bf F\+L\+A\+S\+H\+\_\+\+I\+M\+A\+G\+E\+\_\+\+S\+U\+C\+C\+E\+SS}}\hypertarget{disk_8c_ad018a3100b2dabad325a0800152db297}{}\label{disk_8c_ad018a3100b2dabad325a0800152db297}


Definition at line 45 of file disk.\+c.

\index{disk.\+c@{disk.\+c}!file\+\_\+size@{file\+\_\+size}}
\index{file\+\_\+size@{file\+\_\+size}!disk.\+c@{disk.\+c}}
\subsubsection[{\texorpdfstring{file\+\_\+size}{file_size}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf uint\+\_\+32} file\+\_\+size}\hypertarget{disk_8c_a483026139decebabd2f38b1dc898b594}{}\label{disk_8c_a483026139decebabd2f38b1dc898b594}


Definition at line 43 of file disk.\+c.

\index{disk.\+c@{disk.\+c}!filetype@{filetype}}
\index{filetype@{filetype}!disk.\+c@{disk.\+c}}
\subsubsection[{\texorpdfstring{filetype}{filetype}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf uint\+\_\+8} filetype}\hypertarget{disk_8c_a981c2dadd44a0af32a67280b58013d5b}{}\label{disk_8c_a981c2dadd44a0af32a67280b58013d5b}


Include the OS and B\+SP dependent files that define IO functions and basic types. You may like to change these files for your board and R\+T\+OS. Based on Freescale bootloader demo for k60. 

\begin{DoxyAuthor}{Author}
Xavi Vilajosana \href{mailto:xvilajosana@eecs.berkeley.edu}{\tt xvilajosana@eecs.\+berkeley.\+edu}, June 2012. 
\end{DoxyAuthor}


Definition at line 39 of file Loader.\+c.

\index{disk.\+c@{disk.\+c}!g\+\_\+disk@{g\+\_\+disk}}
\index{g\+\_\+disk@{g\+\_\+disk}!disk.\+c@{disk.\+c}}
\subsubsection[{\texorpdfstring{g\+\_\+disk}{g_disk}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf D\+I\+S\+K\+\_\+\+G\+L\+O\+B\+A\+L\+\_\+\+V\+A\+R\+I\+A\+B\+L\+E\+\_\+\+S\+T\+R\+U\+CT} g\+\_\+disk}\hypertarget{disk_8c_a6ade0b9aa9eb867f1124343246db610b}{}\label{disk_8c_a6ade0b9aa9eb867f1124343246db610b}


Definition at line 51 of file disk.\+c.

\index{disk.\+c@{disk.\+c}!new\+\_\+file@{new\+\_\+file}}
\index{new\+\_\+file@{new\+\_\+file}!disk.\+c@{disk.\+c}}
\subsubsection[{\texorpdfstring{new\+\_\+file}{new_file}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf uint\+\_\+8} new\+\_\+file}\hypertarget{disk_8c_aa62e071f0cf36ef7c535556e3a6df025}{}\label{disk_8c_aa62e071f0cf36ef7c535556e3a6df025}


Definition at line 44 of file disk.\+c.

