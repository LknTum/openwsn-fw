\hypertarget{aes__ccms_8h}{}\section{/home/lkn/off\+Cloud/\+Smartgrid-\/code/\+Git\+Hub/openwsn-\/fw/bsp/boards/common/aes\+\_\+ccms.h File Reference}
\label{aes__ccms_8h}\index{/home/lkn/off\+Cloud/\+Smartgrid-\/code/\+Git\+Hub/openwsn-\/fw/bsp/boards/common/aes\+\_\+ccms.\+h@{/home/lkn/off\+Cloud/\+Smartgrid-\/code/\+Git\+Hub/openwsn-\/fw/bsp/boards/common/aes\+\_\+ccms.\+h}}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{opendefs_8h_af20b7c3ed9d2ba19e56a309ad9314803}{owerror\+\_\+t} \hyperlink{aes__ccms_8h_a561def8d04b8095512cbce4b891113de}{aes\+\_\+ccms\+\_\+enc} (\hyperlink{_p_e___types_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$a, \hyperlink{_p_e___types_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} len\+\_\+a, \hyperlink{_p_e___types_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$m, \hyperlink{_p_e___types_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$len\+\_\+m, \hyperlink{_p_e___types_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$nonce, \hyperlink{_p_e___types_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} l, \hyperlink{_p_e___types_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} key\mbox{[}16\mbox{]}, \hyperlink{_p_e___types_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} len\+\_\+mac)
\begin{DoxyCompactList}\small\item\em Definitions for A\+ES C\+C\+MS implementation. \end{DoxyCompactList}\item 
\hyperlink{opendefs_8h_af20b7c3ed9d2ba19e56a309ad9314803}{owerror\+\_\+t} \hyperlink{aes__ccms_8h_adf203bc4a925617afa32b4d128a547f5}{aes\+\_\+ccms\+\_\+dec} (\hyperlink{_p_e___types_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$a, \hyperlink{_p_e___types_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} len\+\_\+a, \hyperlink{_p_e___types_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$m, \hyperlink{_p_e___types_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$len\+\_\+m, \hyperlink{_p_e___types_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$nonce, \hyperlink{_p_e___types_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} l, \hyperlink{_p_e___types_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} key\mbox{[}16\mbox{]}, \hyperlink{_p_e___types_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} len\+\_\+mac)
\begin{DoxyCompactList}\small\item\em C\+C\+M$\ast$ inverse transformation (i.\+e. decryption + tag verification). \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{aes\+\_\+ccms.\+h@{aes\+\_\+ccms.\+h}!aes\+\_\+ccms\+\_\+dec@{aes\+\_\+ccms\+\_\+dec}}
\index{aes\+\_\+ccms\+\_\+dec@{aes\+\_\+ccms\+\_\+dec}!aes\+\_\+ccms.\+h@{aes\+\_\+ccms.\+h}}
\subsubsection[{\texorpdfstring{aes\+\_\+ccms\+\_\+dec(uint8\+\_\+t $\ast$a, uint8\+\_\+t len\+\_\+a, uint8\+\_\+t $\ast$m, uint8\+\_\+t $\ast$len\+\_\+m, uint8\+\_\+t $\ast$nonce, uint8\+\_\+t l, uint8\+\_\+t key[16], uint8\+\_\+t len\+\_\+mac)}{aes_ccms_dec(uint8_t *a, uint8_t len_a, uint8_t *m, uint8_t *len_m, uint8_t *nonce, uint8_t l, uint8_t key[16], uint8_t len_mac)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf owerror\+\_\+t} aes\+\_\+ccms\+\_\+dec (
\begin{DoxyParamCaption}
\item[{{\bf uint8\+\_\+t} $\ast$}]{a, }
\item[{{\bf uint8\+\_\+t}}]{len\+\_\+a, }
\item[{{\bf uint8\+\_\+t} $\ast$}]{m, }
\item[{{\bf uint8\+\_\+t} $\ast$}]{len\+\_\+m, }
\item[{{\bf uint8\+\_\+t} $\ast$}]{nonce, }
\item[{{\bf uint8\+\_\+t}}]{l, }
\item[{{\bf uint8\+\_\+t}}]{key\mbox{[}16\mbox{]}, }
\item[{{\bf uint8\+\_\+t}}]{len\+\_\+mac}
\end{DoxyParamCaption}
)}\hypertarget{aes__ccms_8h_adf203bc4a925617afa32b4d128a547f5}{}\label{aes__ccms_8h_adf203bc4a925617afa32b4d128a547f5}


C\+C\+M$\ast$ inverse transformation (i.\+e. decryption + tag verification). 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em a} & Pointer to the authentication only data. \\
\hline
\mbox{\tt in}  & {\em len\+\_\+a} & Length of authentication only data. \\
\hline
\mbox{\tt in,out}  & {\em m} & Pointer to the data that is both authenticated and encrypted. Overwritten by plaintext. \\
\hline
\mbox{\tt in,out}  & {\em len\+\_\+m} & Length of data that is both authenticated and encrypted, including the trailing authentication tag. On return it is reduced for len\+\_\+mac octets to account for the removed authentication tag. \\
\hline
\mbox{\tt in}  & {\em nonce} & Buffer containing nonce (13 octets). \\
\hline
\mbox{\tt in}  & {\em l} & C\+CM parameter L that allows selection of different nonce length. This implementation supports l = 2 (i.\+e. 13 octet long nonce) only. \\
\hline
\mbox{\tt in}  & {\em key} & Buffer containing the secret key (16 octets). \\
\hline
\mbox{\tt in}  & {\em len\+\_\+mac} & Length of the authentication tag.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
E\+\_\+\+S\+U\+C\+C\+E\+SS when decryption and verification were successful, E\+\_\+\+F\+A\+IL otherwise. 
\end{DoxyReturn}


Definition at line 77 of file aes\+\_\+ccms.\+c.

\index{aes\+\_\+ccms.\+h@{aes\+\_\+ccms.\+h}!aes\+\_\+ccms\+\_\+enc@{aes\+\_\+ccms\+\_\+enc}}
\index{aes\+\_\+ccms\+\_\+enc@{aes\+\_\+ccms\+\_\+enc}!aes\+\_\+ccms.\+h@{aes\+\_\+ccms.\+h}}
\subsubsection[{\texorpdfstring{aes\+\_\+ccms\+\_\+enc(uint8\+\_\+t $\ast$a, uint8\+\_\+t len\+\_\+a, uint8\+\_\+t $\ast$m, uint8\+\_\+t $\ast$len\+\_\+m, uint8\+\_\+t $\ast$nonce, uint8\+\_\+t l, uint8\+\_\+t key[16], uint8\+\_\+t len\+\_\+mac)}{aes_ccms_enc(uint8_t *a, uint8_t len_a, uint8_t *m, uint8_t *len_m, uint8_t *nonce, uint8_t l, uint8_t key[16], uint8_t len_mac)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf owerror\+\_\+t} aes\+\_\+ccms\+\_\+enc (
\begin{DoxyParamCaption}
\item[{{\bf uint8\+\_\+t} $\ast$}]{a, }
\item[{{\bf uint8\+\_\+t}}]{len\+\_\+a, }
\item[{{\bf uint8\+\_\+t} $\ast$}]{m, }
\item[{{\bf uint8\+\_\+t} $\ast$}]{len\+\_\+m, }
\item[{{\bf uint8\+\_\+t} $\ast$}]{nonce, }
\item[{{\bf uint8\+\_\+t}}]{l, }
\item[{{\bf uint8\+\_\+t}}]{key\mbox{[}16\mbox{]}, }
\item[{{\bf uint8\+\_\+t}}]{len\+\_\+mac}
\end{DoxyParamCaption}
)}\hypertarget{aes__ccms_8h_a561def8d04b8095512cbce4b891113de}{}\label{aes__ccms_8h_a561def8d04b8095512cbce4b891113de}


Definitions for A\+ES C\+C\+MS implementation. 

\begin{DoxyAuthor}{Author}
Marcelo Barros de Almeida \href{mailto:marcelobarrosalmeida@gmail.com}{\tt marcelobarrosalmeida@gmail.\+com}, March 2015.
\end{DoxyAuthor}
Definitions for A\+ES C\+C\+MS implementation.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em a} & Pointer to the authentication only data. \\
\hline
\mbox{\tt in}  & {\em len\+\_\+a} & Length of authentication only data. \\
\hline
\mbox{\tt in,out}  & {\em m} & Pointer to the data that is both authenticated and encrypted. Overwritten by ciphertext and the trailing authentication tag. Buffer must hold len\+\_\+m + C\+B\+C\+\_\+\+M\+A\+C\+\_\+\+S\+I\+ZE. \\
\hline
\mbox{\tt in,out}  & {\em len\+\_\+m} & Length of data that is both authenticated and encrypted. Accounts for the added authentication tag of len\+\_\+mac octets on return. \\
\hline
\mbox{\tt in}  & {\em nonce} & Buffer containing nonce (13 octets). \\
\hline
\mbox{\tt in}  & {\em l} & C\+CM parameter L that allows selection of different nonce length. This implementation supports l = 2 (i.\+e. 13 octet long nonce) only. \\
\hline
\mbox{\tt in}  & {\em key} & Buffer containing the secret key (16 octets). \\
\hline
\mbox{\tt in}  & {\em len\+\_\+mac} & Length of the authentication tag.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
E\+\_\+\+S\+U\+C\+C\+E\+SS when the generation was successful, E\+\_\+\+F\+A\+IL otherwise. 
\end{DoxyReturn}


Definition at line 33 of file aes\+\_\+ccms.\+c.

